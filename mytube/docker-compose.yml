version: '3.8'

services:
  backend:
    image: franklioxygen/mytube:backend-latest
    container_name: mytube-backend
    pull_policy: always
    restart: unless-stopped
    ports:
      - "5551:5551"
    environment:
      - PORT=5551
      - HTTP_PROXY=http://192.168.100.225:7890
      - HTTPS_PROXY=http://192.168.100.225:7890
      # Optional: Set a custom upload directory inside container if needed
      # - VIDEO_DIR=/app/uploads/videos
    volumes:
      - /volume1/docker/mytube/uploads:/app/uploads
      - /volume1/docker/mytube/data:/app/data
    networks:
      - mytube-network

  frontend:
    image: franklioxygen/mytube:frontend-latest
    container_name: mytube-frontend
    pull_policy: always
    restart: unless-stopped
    ports:
      - "5556:5556"
    environment:
      # Internal Docker networking URLs (Browser -> Frontend -> Backend)
      # In most setups, these defaults work fine.
      - VITE_API_URL=/api
      - VITE_BACKEND_URL=
      - HTTP_PROXY=http://192.168.100.225:7890
      - HTTPS_PROXY=http://192.168.100.225:7890
    depends_on:
      - backend
    networks:
      - mytube-network

networks:
  mytube-network:
    driver: bridge